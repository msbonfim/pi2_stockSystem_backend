{% extends "admin/base.html" %}
{% load static %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block branding %}
<h1 id="site-name">
    <a href="{% url 'admin:index' %}">
        {{ site_header|default:_('Django administration') }}
    </a>
</h1>
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<!-- Font Awesome para √≠cones profissionais -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<!-- FOR√áAR REMO√á√ÉO DE MARGENS - CSS INLINE ANTES DE TUDO -->
<style id="force-remove-margins">
/* FOR√áA REMO√á√ÉO DE MARGENS LATERAIS - PRIORIDADE M√ÅXIMA */
html body .main,
html body .main.shifted,
html body div.main,
html body div.main.shifted,
body.admin .main,
body.admin .main.shifted,
body.admin div.main,
body.admin div.main.shifted,
#container .main,
#container .main.shifted,
body .main,
body .main.shifted {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
}
html body #header,
html body header#header,
body.admin #header,
body.admin header#header,
body #header,
#header,
header#header,
div#header,
body #header,
html #header,
#container #header,
#container header#header {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    left: 0 !important;
    transform: translateX(0) !important;
}
</style>
<!-- Modern Admin Styles - Cache Busting com timestamp -->
{% now "U" as cache_buster %}
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/admin_modern.css' %}?v={{ cache_buster }}">
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/accessibility.css' %}?v={{ cache_buster }}">
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/nav_sidebar.css' %}?v={{ cache_buster }}">
<script src="{% static 'admin/js/nav_sidebar_custom.js' %}?v={{ cache_buster }}"></script>
<style>
/* FOR√áAR oculta√ß√£o da sidebar de filtros */
#content-related {
    display: none !important;
    visibility: hidden !important;
    width: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    position: absolute !important;
    left: -9999px !important;
}

.colMS {
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    float: none !important;
    box-sizing: border-box !important;
}

.main.shifted .colMS {
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
}

/* Garantir que changelist ocupe 100% */
#changelist {
    width: 100% !important;
    max-width: 100% !important;
}

#changelist .changelist-form-container {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
}

#changelist-form {
    width: 100% !important;
    max-width: 100% !important;
}

#changelist table {
    width: 100% !important;
    max-width: 100% !important;
}

#result_list {
    width: 100% !important;
    max-width: 100% !important;
}
</style>
<style id="admin-modern-critical-inline">
/* CSS Cr√≠tico Inline - Layout Limpo e Profissional */
/* FOR√áAR REMO√á√ÉO DE MARGENS LATERAIS - M√ÅXIMA ESPECIFICIDADE */
html body .main,
html body .main.shifted,
html body div.main,
html body div.main.shifted,
body.admin .main,
body.admin .main.shifted,
body.admin div.main,
body.admin div.main.shifted,
#container > .main,
#container > .main.shifted {
    margin-left: 0 !important;
}
html body #header,
html body header#header,
body.admin #header,
body.admin header#header {
    margin-left: 0 !important;
}
body:not(.admin-accessibility-dark-theme) {
    background: #f7fafc !important;
    min-height: 100vh !important;
}
#header:not(body.admin-accessibility-dark-theme #header) {
    background: #2d3748 !important;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1) !important;
    border-bottom: none !important;
    padding: 0.75rem 1.5rem !important;
}
#header #site-name a {
    color: #ffffff !important;
    font-weight: 600 !important;
    font-size: 1.25rem !important;
}
/* Respeitar tamanhos de acessibilidade */
body.admin-accessibility-large #header #site-name a,
body.admin-accessibility-xlarge #header #site-name a,
body.admin-accessibility-xxlarge #header #site-name a {
    font-size: inherit !important;
}
.module:not(body.admin-accessibility-dark-theme .module) {
    background: #ffffff !important;
    border: 1px solid #e2e8f0 !important;
    border-radius: 8px !important;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05) !important;
    margin-bottom: 1rem !important;
    transition: all 0.2s ease !important;
    overflow: hidden !important;
}
.module:hover:not(body.admin-accessibility-dark-theme .module:hover) {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
    border-color: #cbd5e0 !important;
}
.module h2:not(body.admin-accessibility-dark-theme .module h2) {
    background: #4a5568 !important;
    padding: 0.75rem 1rem !important;
    margin: 0 !important;
    border-bottom: none !important;
    font-size: 0.9375rem !important;
    font-weight: 600 !important;
    color: #ffffff !important;
    text-transform: uppercase !important;
}
/* Respeitar tamanhos de acessibilidade */
body.admin-accessibility-large .module h2,
body.admin-accessibility-xlarge .module h2,
body.admin-accessibility-xxlarge .module h2 {
    font-size: inherit !important;
}
.button, input[type="submit"], .submit-row input {
    background: #4a5568 !important;
    color: #ffffff !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    border: none !important;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05) !important;
    transition: all 0.2s ease !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    font-size: 0.875rem !important;
}
.button:hover, input[type="submit"]:hover, .submit-row input:hover {
    background: #2d3748 !important;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
}
#content {
    padding: 1rem 1.25rem !important;
    max-width: 100% !important;
    width: 100% !important;
}
#content-main {
    padding: 0 !important;
    background: transparent !important;
    width: 100% !important;
    max-width: 100% !important;
    float: none !important;
}
.colMS {
    margin-right: 280px !important;
    width: calc(100% - 280px) !important;
    box-sizing: border-box !important;
}
#changelist, #result_list, #changelist-form, form {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
}
#changelist .results, #changelist .results table {
    width: 100% !important;
    max-width: 100% !important;
}
/* Remover bordas das tabelas */
table th, table td, #result_list th, #result_list td {
    border: none !important;
    border-bottom: none !important;
}
#result_list tbody tr:nth-child(even) {
    background: #fafbfc;
}
#result_list tbody tr:nth-child(odd) {
    background: #ffffff;
}
/* Remover bordas das tabelas - INLINE */
table th, table td, #result_list th, #result_list td, .changelist-results th, .changelist-results td {
    border: none !important;
    border-bottom: none !important;
}
#result_list tbody tr:nth-child(even) {
    background: #fafbfc !important;
}
#result_list tbody tr:nth-child(odd) {
    background: #ffffff !important;
}
/* Ajustar layout quando sidebar abre - sem margens */
.main.shifted .colMS {
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
}
/* Menu lateral compacto - garantir que funcione */
.toggle-nav-sidebar {
    width: 48px !important;
    min-width: 48px !important;
    flex: 0 0 48px !important;
    background-color: #2d3748 !important;
    color: #ffffff !important;
}
/* Sidebar fechado: removendo margem lateral esquerda - FOR√áAR COM M√ÅXIMA ESPECIFICIDADE */
html body .main,
html body div.main,
body.admin .main,
body.admin div.main {
    margin-left: 0 !important;
    margin-right: 0 !important;
    transition: margin-left 0.3s ease !important;
}
html body #header,
html body header#header,
body.admin #header,
body.admin header#header,
#header,
header#header,
div#header,
body #header,
html #header,
#container #header,
#container header#header {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 1.5rem !important;
    padding-right: 1.5rem !important;
    left: 0 !important;
    transform: translateX(0) !important;
    transition: margin-left 0.3s ease !important;
}
/* Sidebar aberto: removendo margem lateral esquerda - FOR√áAR COM M√ÅXIMA ESPECIFICIDADE */
html body .main.shifted,
html body div.main.shifted,
body.admin .main.shifted,
body.admin div.main.shifted {
    margin-left: 0 !important;
    margin-right: 0 !important;
}
html body .main.shifted #header,
html body div.main.shifted #header,
body.admin .main.shifted #header,
body.admin div.main.shifted #header,
.main.shifted #header,
#header.shifted,
header.shifted {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 1.5rem !important;
    padding-right: 1.5rem !important;
    left: 0 !important;
    transform: translateX(0) !important;
}
.main.shifted #nav-sidebar {
    left: 48px !important;
    width: 240px !important;
}
/* Garantir que conte√∫do se ajuste corretamente - sem margem lateral */
.main.shifted .colMS {
    width: 100% !important;
    max-width: 100% !important;
}
.colMS {
    width: 100% !important;
    max-width: 100% !important;
}
/* ========================================
   QUANDO SIDEBAR FECHADO - FOR√áAR APENAS √çCONES
   M√ÅXIMA ESPECIFICIDADE NO INLINE CSS
   ======================================== */
html body .main:not(.shifted) #nav-sidebar .module table td,
body .main:not(.shifted) #nav-sidebar .module table td {
    width: 60px !important;
    max-width: 60px !important;
    min-width: 60px !important;
    padding: 0 !important;
    text-align: center !important;
    overflow: hidden !important;
}
html body .main:not(.shifted) #nav-sidebar .module table td a,
body .main:not(.shifted) #nav-sidebar .module table td a,
html body .main:not(.shifted) #nav-sidebar .module table tbody td a,
body .main:not(.shifted) #nav-sidebar .module table tbody td a {
    display: block !important;
    width: 44px !important;
    height: 44px !important;
    min-width: 44px !important;
    max-width: 44px !important;
    min-height: 44px !important;
    max-height: 44px !important;
    padding: 0 !important;
    margin: 0.25rem auto !important;
    position: relative !important;
    text-indent: -99999px !important;
    overflow: hidden !important;
    font-size: 0px !important;
    line-height: 0 !important;
    color: transparent !important;
    text-decoration: none !important;
    white-space: nowrap !important;
}
html body .main:not(.shifted) #nav-sidebar .module table td a *,
body .main:not(.shifted) #nav-sidebar .module table td a *,
html body .main:not(.shifted) #nav-sidebar .module table td *,
body .main:not(.shifted) #nav-sidebar .module table td * {
    font-size: 0px !important;
    line-height: 0 !important;
    text-indent: -99999px !important;
    opacity: 0 !important;
    visibility: hidden !important;
    display: none !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
}
html body .main:not(.shifted) #nav-sidebar .module table td a::before,
body .main:not(.shifted) #nav-sidebar .module table td a::before {
    content: 'üìã' !important;
    display: block !important;
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-size: 1.5rem !important;
    line-height: 1 !important;
    text-indent: 0 !important;
    color: rgba(255, 255, 255, 0.8) !important;
    z-index: 999 !important;
    width: auto !important;
    height: auto !important;
    margin: 0 !important;
    padding: 0 !important;
    opacity: 1 !important;
    visibility: visible !important;
}
html body .main:not(.shifted) #nav-sidebar .module h2,
body .main:not(.shifted) #nav-sidebar .module h2 {
    font-size: 0px !important;
    height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    overflow: hidden !important;
    opacity: 0 !important;
    visibility: hidden !important;
    line-height: 0 !important;
    max-height: 0 !important;
}
html body .main:not(.shifted) #nav-sidebar .module table,
body .main:not(.shifted) #nav-sidebar .module table {
    width: 60px !important;
    max-width: 60px !important;
}
/* QUANDO SIDEBAR ABERTO - mostrar texto e √≠cones */
.main.shifted #nav-sidebar .module table td {
    width: auto !important;
    max-width: none !important;
}
.main.shifted #nav-sidebar .module table td a {
    display: flex !important;
    align-items: center !important;
    justify-content: flex-start !important;
    width: auto !important;
    height: auto !important;
    padding: 0.75rem 1rem !important;
    margin: 0.25rem 0.5rem !important;
    text-indent: 0 !important;
    font-size: 0.875rem !important;
    line-height: 1.5 !important;
    color: rgba(255, 255, 255, 0.8) !important;
}
.main.shifted #nav-sidebar .module table td a * {
    font-size: 0.875rem !important;
    opacity: 1 !important;
    visibility: visible !important;
    display: inline !important;
}
.main.shifted #nav-sidebar .module table td a::before {
    position: static !important;
    transform: none !important;
    margin-right: 0.75rem !important;
}
#result_list:not(body.admin-accessibility-dark-theme #result_list) {
    background: #ffffff !important;
    border-radius: 8px !important;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05) !important;
    overflow: hidden !important;
}
.skip-link, #skip-link {
    display: none !important;
    visibility: hidden !important;
}
/* Painel de acessibilidade - M√ÅXIMA ESPECIFICIDADE para garantir que apare√ßa */
html body #accessibility-panel[aria-hidden="false"],
html body #accessibility-panel[style*="display: flex"],
html body #accessibility-panel[style*="display:flex"],
body.admin #accessibility-panel[aria-hidden="false"] {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) scale(1) !important;
}
/* Tamanhos de fonte - FOR√áADO no CSS inline tamb√©m */
body.admin-accessibility-large *,
body.admin-accessibility-large p,
body.admin-accessibility-large span,
body.admin-accessibility-large a,
body.admin-accessibility-large td,
body.admin-accessibility-large th,
body.admin-accessibility-large label,
body.admin-accessibility-large div {
    font-size: 1.125rem !important;
}
body.admin-accessibility-xlarge *,
body.admin-accessibility-xlarge p,
body.admin-accessibility-xlarge span,
body.admin-accessibility-xlarge a,
body.admin-accessibility-xlarge td,
body.admin-accessibility-xlarge th,
body.admin-accessibility-xlarge label,
body.admin-accessibility-xlarge div {
    font-size: 1.25rem !important;
}
body.admin-accessibility-xxlarge *,
body.admin-accessibility-xxlarge p,
body.admin-accessibility-xxlarge span,
body.admin-accessibility-xxlarge a,
body.admin-accessibility-xxlarge td,
body.admin-accessibility-xxlarge th,
body.admin-accessibility-xxlarge label,
body.admin-accessibility-xxlarge div {
    font-size: 1.5rem !important;
}
</style>
<script>
/* FOR√áA REMO√á√ÉO DE MARGENS LATERAIS - EXECUTA IMEDIATAMENTE */
(function() {
    'use strict';
    function forceRemoveMargins() {
        // Seleciona todos os elementos .main e #header
        const mainElements = document.querySelectorAll('.main, .main.shifted, #header, header#header, header');
        const headerElements = document.querySelectorAll('#header, header#header, header, div#header, body > header');
        mainElements.forEach(function(el) {
            if (el && (el.id === 'header' || el.classList.contains('main') || el.tagName === 'HEADER')) {
                el.style.setProperty('margin-left', '0', 'important');
                el.style.setProperty('margin-right', '0', 'important');
            }
        });
        // For√ßa remo√ß√£o de margens do header especificamente
        headerElements.forEach(function(el) {
            if (el) {
                el.style.setProperty('margin-left', '0', 'important');
                el.style.setProperty('margin-right', '0', 'important');
                el.style.setProperty('left', '0', 'important');
                el.style.setProperty('transform', 'translateX(0)', 'important');
                // Remove qualquer margin inline
                if (el.style.marginLeft && (el.style.marginLeft.includes('px') || el.style.marginLeft.includes('rem') || el.style.marginLeft.includes('em'))) {
                    el.style.marginLeft = '0';
                }
            }
        });
        
        // Remove regras CSS inline ou de stylesheet que contenham essas margens
        const styleSheets = document.styleSheets;
        for (let i = 0; i < styleSheets.length; i++) {
            try {
                const sheet = styleSheets[i];
                if (sheet.cssRules) {
                    for (let j = 0; j < sheet.cssRules.length; j++) {
                        const rule = sheet.cssRules[j];
                        if (rule.selectorText && (rule.selectorText.includes('.main') || rule.selectorText.includes('#header') || rule.selectorText.includes('header'))) {
                            if (rule.style) {
                                // Remove margin-left de 108px, 288px, 300px, ou qualquer valor para header/main
                                const marginLeft = rule.style.marginLeft;
                                if (marginLeft && (marginLeft.includes('108px') || marginLeft.includes('288px') || marginLeft.includes('300px') || (rule.selectorText.includes('#header') && marginLeft !== '0' && marginLeft !== '0px'))) {
                                    rule.style.setProperty('margin-left', '0', 'important');
                                }
                            }
                        }
                    }
                }
            } catch (e) {
                // Ignora erros de CORS
            }
        }
    }
    
    // Executa imediatamente
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', forceRemoveMargins);
    } else {
        forceRemoveMargins();
    }
    
    // Executa novamente ap√≥s um delay para garantir
    setTimeout(forceRemoveMargins, 100);
    setTimeout(forceRemoveMargins, 500);
    
    // Observa mudan√ßas no DOM - apenas se body existir
    if (window.MutationObserver && document.body) {
        const observer = new MutationObserver(function(mutations) {
            forceRemoveMargins();
        });
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['style', 'class']
        });
    } else if (window.MutationObserver) {
        // Se body ainda n√£o existe, aguardar
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                if (document.body) {
                    const observer = new MutationObserver(function(mutations) {
                        forceRemoveMargins();
                    });
                    observer.observe(document.body, {
                        childList: true,
                        subtree: true,
                        attributes: true,
                        attributeFilter: ['style', 'class']
                    });
                }
            });
        }
    }
})();
</script>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- FOR√áA REMO√á√ÉO DE MARGENS - √öLTIMA PRIORIDADE NO HEAD -->
<style id="force-remove-margins-final">
/* FOR√áA REMO√á√ÉO DE MARGENS LATERAIS - M√ÅXIMA PRIORIDADE FINAL */
html body .main,
html body .main.shifted,
html body div.main,
html body div.main.shifted,
body.admin .main,
body.admin .main.shifted,
body.admin div.main,
body.admin div.main.shifted,
#container .main,
#container .main.shifted,
body .main,
body .main.shifted,
.main,
.main.shifted {
    margin-left: 0 !important;
    margin-right: 0 !important;
}
html body #header,
html body header#header,
body.admin #header,
body.admin header#header,
body #header,
#header,
header#header,
#container #header,
#container header#header {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    left: 0 !important;
    right: 0 !important;
}
</style>
{% endblock %}

{% block footer %}
{{ block.super }}
<!-- Accessibility JavaScript -->
<script type="text/javascript" src="{% static 'admin/js/accessibility.js' %}?v=3.0"></script>
<script>
// Garante que o Accessibility esteja dispon√≠vel e funcione
(function() {
  'use strict';
  function initAccessibility() {
    console.log('üîß Verificando Accessibility...');
    
    if (typeof Accessibility !== 'undefined') {
      console.log('‚úÖ Accessibility API carregada!');
      
      // For√ßa cria√ß√£o do bot√£o e painel se n√£o existirem
      setTimeout(function() {
        if (!document.getElementById('accessibility-toggle')) {
          console.log('‚ö†Ô∏è Bot√£o n√£o encontrado, criando...');
          if (Accessibility.init) {
            Accessibility.init();
          }
        }
        if (!document.getElementById('accessibility-panel')) {
          console.log('‚ö†Ô∏è Painel n√£o encontrado, criando...');
          if (Accessibility.init) {
            Accessibility.init();
          }
        }
        
        // Testa o bot√£o e adiciona handler
        var btn = document.getElementById('accessibility-toggle');
        var panel = document.getElementById('accessibility-panel');
        if (btn) {
          console.log('‚úÖ Bot√£o de acessibilidade encontrado!');
          // Remove handlers antigos
          var newBtn = btn.cloneNode(true);
          btn.parentNode.replaceChild(newBtn, btn);
          // Adiciona novo handler
          newBtn.addEventListener('click', function(e) {
            console.log('üîò Bot√£o clicado!');
            e.preventDefault();
            e.stopPropagation();
            if (typeof Accessibility !== 'undefined' && Accessibility.togglePanel) {
              console.log('üìû Chamando Accessibility.togglePanel()');
              Accessibility.togglePanel();
            } else {
              console.error('‚ùå Accessibility.togglePanel n√£o dispon√≠vel');
            }
          });
        } else {
          console.error('‚ùå Bot√£o n√£o foi criado!');
        }
        if (panel) {
          console.log('‚úÖ Painel encontrado!');
        } else {
          console.error('‚ùå Painel n√£o foi criado!');
        }
      }, 500);
    } else {
      console.warn('‚ö†Ô∏è Accessibility API n√£o encontrada, tentando recarregar...');
      var script = document.createElement('script');
      script.src = "{% static 'admin/js/accessibility.js' %}?v=" + Date.now();
      script.onload = function() {
        console.log('‚úì Accessibility.js carregado com sucesso!');
        setTimeout(initAccessibility, 100);
      };
      script.onerror = function() {
        console.error('‚úó Erro ao carregar accessibility.js');
      };
      document.body.appendChild(script);
    }
  }
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initAccessibility);
  } else {
    setTimeout(initAccessibility, 200);
  }
})();
</script>

<script>
/* Remover bordas de foco dinamicamente ao clicar em qualquer elemento */
(function() {
  'use strict';
  
  function removeFocusBorders() {
    // Remove apenas outline e box-shadow de elementos com foco - MAS N√ÉO SELECTS, INPUTS (incluindo checkbox), TEXTAREAS
    document.querySelectorAll('*:focus').forEach(function(el) {
      // N√£o fazer nada se for um select, input (qualquer tipo incluindo checkbox), textarea ou option
      if (el.tagName === 'SELECT' || 
          el.tagName === 'INPUT' || 
          el.tagName === 'TEXTAREA' ||
          el.tagName === 'OPTION' || 
          el.type === 'checkbox' ||
          el.classList.contains('action-select') ||
          el.closest('select, input, textarea, .actions')) {
        return;
      }
      
      // Remover apenas outline e box-shadow, N√ÉO border
      el.style.outline = 'none';
      el.style.outlineOffset = '0';
      el.style.boxShadow = 'none';
      // N√ÉO remover border - deixar como est√° ou manter padr√£o
    });
  }
  
  // Event listeners para remover bordas - MAS N√ÉO INTERFERIR COM SELECTS, INPUTS E CHECKBOXES
  document.addEventListener('click', function(e) {
    const target = e.target;
    
    // Se for um select, input (incluindo checkbox), textarea ou elemento dentro deles, N√ÉO fazer nada
    if (target.tagName === 'SELECT' || 
        target.tagName === 'INPUT' || 
        target.tagName === 'TEXTAREA' ||
        target.tagName === 'OPTION' ||
        target.type === 'checkbox' ||
        target.classList.contains('action-select') ||
        target.closest('select, input, textarea, .actions')) {
      return;
    }
    
    // Remove apenas outline e box-shadow do elemento clicado (n√£o border)
    if (target) {
      target.style.outline = 'none';
      target.style.outlineOffset = '0';
      target.style.boxShadow = 'none';
      
      // Remove apenas outline e box-shadow de elementos pais (n√£o border)
      let parent = target.parentElement;
      let depth = 0;
      while (parent && depth < 5) {
        parent.style.outline = 'none';
        parent.style.outlineOffset = '0';
        parent.style.boxShadow = 'none';
        parent = parent.parentElement;
        depth++;
      }
    }
    
    // Remove foco de todos os elementos - MAS N√ÉO SE FOR SELECT, INPUT (incluindo checkbox), TEXTAREA OU CHECKBOXES
    if (document.activeElement && 
        document.activeElement !== document.body) {
      const activeEl = document.activeElement;
      // S√≥ remover foco se n√£o for um select, input (qualquer tipo), textarea, checkbox ou elemento relacionado
      if (activeEl.tagName !== 'SELECT' && 
          activeEl.tagName !== 'INPUT' && 
          activeEl.tagName !== 'TEXTAREA' &&
          activeEl.tagName !== 'OPTION' &&
          activeEl.type !== 'checkbox' &&
          !activeEl.classList.contains('action-select') &&
          !activeEl.closest('select, input, textarea, .actions')) {
        activeEl.blur();
      }
    }
  }, false); // Mudado de true para false - n√£o usar capture phase
  
  // Remover bordas quando elementos recebem foco - MAS N√ÉO PARA SELECTS, INPUTS (incluindo checkbox), TEXTAREAS
  document.addEventListener('focusin', function(e) {
    const target = e.target;
    
    // Se for um select, input (qualquer tipo incluindo checkbox), textarea ou option, N√ÉO fazer nada
    if (target.tagName === 'SELECT' || 
        target.tagName === 'INPUT' || 
        target.tagName === 'TEXTAREA' ||
        target.tagName === 'OPTION' || 
        target.type === 'checkbox' ||
        target.classList.contains('action-select') ||
        target.closest('select, input, textarea, .actions')) {
      return;
    }
    
    // Para outros elementos, remover apenas outline e box-shadow (n√£o border)
    if (target) {
      target.style.outline = 'none';
      target.style.outlineOffset = '0';
      target.style.boxShadow = 'none';
    }
  }, false); // Mudado de true para false - n√£o usar capture phase
  
  // Executar periodicamente para garantir que n√£o apare√ßam bordas
  // MAS apenas para elementos que n√£o sejam selects, inputs (incluindo checkbox), textareas ou checkboxes
  setInterval(function() {
    // Verificar se n√£o h√° um select, input (qualquer tipo), textarea ou checkbox com foco antes de remover bordas
    const activeEl = document.activeElement;
    if (activeEl && 
        activeEl.tagName !== 'SELECT' && 
        activeEl.tagName !== 'INPUT' && 
        activeEl.tagName !== 'TEXTAREA' &&
        activeEl.tagName !== 'OPTION' &&
        activeEl.type !== 'checkbox' &&
        !activeEl.classList.contains('action-select') &&
        !activeEl.closest('select, input, textarea, .actions')) {
      removeFocusBorders();
    }
  }, 100);
  
  // Executar imediatamente
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', removeFocusBorders);
  } else {
    removeFocusBorders();
  }
})();
</script>
{% endblock %}
